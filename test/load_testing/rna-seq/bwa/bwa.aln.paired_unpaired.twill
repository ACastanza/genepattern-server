# Test cases for BWA.aln
#
# Note 1: when using a custom index, you must explicitly deselect the first item from the
# prebuilt.bowtie.index choice list. This prevents the error message:
#    Either a pre-built bowtie index or custom bowtie index must be specified but not both
# This is a result of the way twill handles forms with 'select' menus,
# and is not a problem when using a web browser.
#

# Step 1, BWA.aln, custom-bowtie index, unpaired read, default settings
#### exp_1.fa ####
go /gp/pages/index.jsf?lsid=BWA.aligner
# deselect the first item, hard coded to 'a_thaliana', from the prebuilt.bowtie.index
# see Note 1 above
fv taskForm custom.BWA.index_cb url
fv taskForm custom.BWA.index_url "${rnaseqdata}/Testing_HT/TopHat_20101215/chr4BowtieIndex.zip"
fv taskForm reads.pair.1_cb url
fv taskForm reads.pair.1_url "${rnaseqdata}/Testing_HT/TopHat_20101215/exp_1.fa"
fv taskForm output.file Testing_HT_<reads.pair.1_basename>_unpaired.sam
submit

# Step 2, BWA.aln, custom-bowtie index, paired read, default settings
#### exp_2.fa ####
go /gp/pages/index.jsf?lsid=Bowtie.aligner
fv taskForm custom.BWA.index_cb url
fv taskForm custom.BWA.index_url "${rnaseqdata}/Testing_HT/TopHat_20101215/chr4BowtieIndex.zip"
fv taskForm reads.pair.1_cb url
fv taskForm reads.pair.1_url "${rnaseqdata}/Testing_HT/TopHat_20101215/exp_1.fa"
fv taskForm reads.pair.2_cb url
fv taskForm reads.pair.2_url "${rnaseqdata}/Testing_HT/TopHat_20101215/exp_2.fa"
fv taskForm output.file Testing_HT_<reads.pair.1_basename>_paired.sam
submit
