<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- /*
The Broad Institute
SOFTWARE COPYRIGHT NOTICE AGREEMENT
This software and its documentation are copyright (2003-2011) by the
Broad Institute/Massachusetts Institute of Technology. All rights are
reserved.
This software is supplied without any warranty or guaranteed support
whatsoever. Neither the Broad Institute nor MIT can be responsible for its
use, misuse, or functionality.
*/ -->
<html xmlns="http://www.w3.org/1999/xhtml" 
		xmlns:ui="http://java.sun.com/jsf/facelets" 
		xmlns:h="http://java.sun.com/jsf/html" 
		xmlns:f="http://java.sun.com/jsf/core" 
		xmlns:t="http://myfaces.apache.org/tomahawk"
		xmlns:c="http://java.sun.com/jstl/core">
    <ui:composition template="/templates/common.xhtml">
        <ui:define name="pageTitle">
            Receive GenomeSpace File #{genomeSpaceReceiveBean.refreshPage}
        </ui:define>
        <ui:define name="body">
            <t:div rendered="#{not genomeSpaceBean.loggedIn or not genomeSpaceBean.genomeSpaceEnabled}">
				<h2>Unable to access to the GenomeSpace landing page.</h2><br/>
				<h:outputText rendered="#{not genomeSpaceBean.genomeSpaceEnabled}"><em>GenomeSpace is not enabled.</em><br/></h:outputText>
				<h:outputText rendered="#{not genomeSpaceBean.loggedIn}"><em>Not logged in to GenomeSpace.</em><br/></h:outputText>
			</t:div>
			<t:div rendered="#{genomeSpaceBean.loggedIn and genomeSpaceBean.genomeSpaceEnabled}">
	        	<h2>GenomeSpace has sent you a file</h2>
				<t:dataList var="file" value="#{genomeSpaceReceiveBean.receivedFiles}" rowIndexVar="index">
					<t:div style="text-indent:50px;"><strong>#{file.file.name}</strong>
					<h:outputText rendered="#{file.file.converted}"> <em>Converted to #{file.file.kind}</em></h:outputText>
					<ol style="margin-left:50px;">
						<h:form target="_blank">
							<li style="text-indent:10px;">Save a Copy: 
								<t:selectOneMenu value="#{genomeSpaceReceiveBean.rootUploadDirectory}" id="uploadDirectory">
									<f:selectItems value="#{genomeSpaceReceiveBean.uploadDirectories}" />
								</t:selectOneMenu>
								<h:inputHidden id="path" value="#{file.file.url}"/>
								<h:commandButton value="Submit" action="#{genomeSpaceReceiveBean.prepareSaveFile}" immediate="true">
								</h:commandButton>
							</li>
						</h:form>
						<t:dataList value="#{file.file.conversions}" var="format">
							<h:form target="_blank">
								<li style="text-indent:10px;">Send to Module as #{format}:
									<t:selectOneMenu id="module" forceId="true">
										<f:selectItems value="#{file.moduleSelects[format]}" />
									</t:selectOneMenu>
									<h:inputHidden id="source" value="GenomeSpace"/>
									<h:inputHidden id="name" value="#{file.file.name}"/>
									<h:inputHidden id="path" value="#{file.file.url}"/>
									<h:inputHidden id="format" value="#{format}"/>
									<h:commandButton value="Submit" action="#{genomeSpaceReceiveBean.loadTask}" immediate="true">
									</h:commandButton>
								</li>
							</h:form>
						</t:dataList>
					</ol>
				</t:div>
				</t:dataList>
				<t:div style="text-indent:50px;" rendered="#{empty genomeSpaceReceiveBean.receivedFiles}">
					<strong>No files were received</strong>
				</t:div>
			</t:div>
        </ui:define>
    </ui:composition>
</html>
