<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:c="http://java.sun.com/jstl/core">

<ui:composition>

<script language="JavaScript">
    function togglePermissionsDiv(divId) {
        //toggle state
        var show = document.getElementById(divId).style.display == 'none'; 

        document.getElementById(divId).style.display = (document.getElementById(divId).style.display == 'none' ? '' : 'none'); 
        document.getElementById('userGroupText').innerHTML = (document.getElementById('userGroupText').innerHTML == 'edit' ? 'hide' : 'edit');
        document.getElementById('showPermissionsDiv').value = show ? 'true' : 'false';
        return false;
    }
</script>

<table width="100%"  border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td><img border="0" src="/gp/images/group.gif"/> Sharing: <em>#{jobPermissionsBean.public ? 'Public' : jobPermissionsBean.shared ? 'Shared' : 'Private'}</em>
        [<a href="#" onclick="togglePermissionsDiv('permissionDiv'); return false;"><span id="userGroupText">#{jobPermissionsBean.showPermissionsDiv ? 'hide' : 'edit'}</span></a>]</td>
  </tr>
  <tr id="permissionDiv" style="#{jobPermissionsBean.showPermissionsDiv ? 'display:;' : 'display:none;'}">
  <td>

<div id="shareEdit">

<h:form id="jobResultsPermissionsForm">
  <input type="hidden" name="jobNumber" value="#{jobInfoBean.jobNumber}" />
  <t:inputHidden id="showPermissionsDiv" forceId="true" value="#{jobPermissionsBean.showPermissionsDiv}" />
<table cellpadding="0" cellspacing="0" class="main" >
  <tr class="Title">
    <td colspan="2" class="TD2">
      <h:outputText>Access permissions for job # #{jobInfoBean.jobInfoWrapper.jobNumber}</h:outputText>
    </td>
  </tr>
  <tr class="White">
    <td class="TD2"><b>Owner:</b></td>
    <td>
      <h:outputText>#{jobInfoBean.jobInfoWrapper.owner}</h:outputText>
    </td>
  </tr>

  <tr class="Brown">
    <td class="TD2"><b>Public access:</b></td>
    <td>
      <t:selectOneRadio value="#{jobPermissionsBean.publicAccessPermission}">
        <f:selectItem itemValue="NONE" itemLabel="None" />
        <f:selectItem itemValue="READ" itemLabel="Read Only" />
        <f:selectItem itemValue="READ_WRITE" itemLabel="Read and Write" />
      </t:selectOneRadio>
    </td>
  </tr>
  <t:outputText escape="false" rendered="#{jobPermissionsBean.numGroupAccessPermissions gt 0}">
  <tr>
    <td class="TD2"><b>Group access:</b></td>
    <td>
    </td>
  </tr>
  <t:dataList var="groupPermission" rowIndexVar="rowIndex" value="#{jobPermissionsBean.groupAccessPermissions}">
  <tr class="#{rowIndex % 2 == 0 ? 'Brown' : 'White'}">
  <td class="TD2">    #{groupPermission.groupId}</td>
  <td>
    <table><tr>
      <t:outputText escape="false" rendered="#{groupPermission.permission == 'NONE'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="NONE" checked="checked" />&#160;None</label></td>
      </t:outputText>
      <t:outputText escape="false" rendered="#{groupPermission.permission != 'NONE'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="NONE"  />&#160;None</label></td>
      </t:outputText>

      <t:outputText escape="false" rendered="#{groupPermission.permission == 'READ'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="READ" checked="checked" />&#160;Read Only</label></td>
      </t:outputText>
      <t:outputText escape="false" rendered="#{groupPermission.permission != 'READ'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="READ"  />&#160;Read Only</label></td>
      </t:outputText>

      <t:outputText escape="false" rendered="#{groupPermission.permission == 'READ_WRITE'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="READ_WRITE" checked="checked" />&#160;Read and Write</label></td>
      </t:outputText>
      <t:outputText escape="false" rendered="#{groupPermission.permission != 'READ_WRITE'}">
      <td><label><input type="radio" name="jobAccessPerm:#{groupPermission.groupId}" value="READ_WRITE"  />&#160;Read and Write</label></td>
      </t:outputText>
    </tr>
    </table>
  </td>
  </tr>
  </t:dataList>
  </t:outputText>
</table>
<h:commandButton action="#{jobPermissionsBean.savePermissions}" value="save permissions" />
</h:form>
</div>
</td>
</tr>
</table>

</ui:composition>

</html>
    