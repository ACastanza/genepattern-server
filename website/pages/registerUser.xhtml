<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:b="http://broad.mit.edu/jsf">

<ui:composition template="/templates/common.xhtml">
  <ui:define name="validationInit">
    <script type="text/javascript" language="javascript"> 
      /* <![CDATA[ */
      function onLoad()
      {
        var objForm = document.forms["registrationForm"];
        objForm.username.required = 1;
        objForm.username.regexp = /^\w*$/;
        objForm.username.err = "Missing or invalid username";

        objForm.password.required = 1;
        objForm.password.regexp = /^\w*$/;
        objForm.password.err = "Missing or invalid password";

        objForm.passwordConfirm.equals = "password";
        objForm.passwordConfirm.err = "Passwords do not match";
 
        objForm.email.required = 1;
        objForm.email.regexp = "JSVAL_RX_EMAIL";
        objForm.email.err = "Missing or invalid email";

        objForm.emailConfirm.equals = "email";
        objForm.emailConfirm.err = "Emails do not match";
      }
       /* ]]> */

    </script>
  </ui:define>
  
  <ui:define name="pageTitle">Register User</ui:define>
  <ui:define name="body">
    <h:form onclick="return validateForm(this);" id="registrationForm">
      <h2>Enter the following information to create an account.</h2>
      <b/>
      <h:panelGrid columns="2">
        <h:outputLabel value="Username:" for="username"/>
        <t:inputText size="50" value="#{registrationBean.username}" id="username"
                     forceId="true" 
                     required="true" requiredMessage="Username is required" 
                     validator="#{registrationBean.validateNewUsername}"/>
                     
        <h:outputLabel value="Password:" for="password"/>
        <t:inputSecret size="50" value="#{registrationBean.password}" id="password" 
                       forceId="true" 
                       required="true" requiredMessage="Password is required" validator="#{registrationBean.validatePassword}"/>
                       
        <h:outputLabel value="Re-enter password:" for="passwordConfirm"/>
        <t:inputSecret size="50" value="#{registrationBean.passwordConfirm}" id="passwordConfirm" 
                       forceId="true" 
                       binding="#{registrationBean.passwordConfirmComponent}"/>
                       
        <h:outputLabel value="Email:" for="email"/>
        <t:inputText size="50" value="#{registrationBean.email}" id="email" 
                     forceId="true" 
                     required="true" requiredMessage="Email is required" validator="#{registrationBean.validateEmail}">
          <t:validateEmail/>
        </t:inputText>
        
        <h:outputLabel value="Re-enter email" for="emailConfirm"/>
        <t:inputText size="50" value="#{registrationBean.emailConfirm}" id="emailConfirm" 
                     forceId="true" 
                     binding="#{registrationBean.emailConfirmComponent}">
          <t:validateEmail/>
        </t:inputText>
        
      </h:panelGrid>
      <h:commandButton value="Create account" class="little" actionListener="#{registrationBean.registerUser}"/>
    </h:form>
  </ui:define>
</ui:composition>

</html>
