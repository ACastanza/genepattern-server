<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>SNP Copy Number Determination</title>
	<link href="../../css/protocolsWindow.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../js/protocol.js"></script>
</head>

<body>

<h1>SNP Copy Number and Loss of Heterozygosity Determination</h1>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td align="left">
      <a href="protocols.html">protocols</a>
    </td>
    <td align="right">
      <a href="http://www.broad.mit.edu/cancer/software/genepattern/protocols/?p=7">comments/suggestions</a>
    </td>
  </tr>
</table>

<p>
Compute SNP copy number and loss of heterozygosity (LOH) based on 
Affymetrix SNP chip data for paired target/normal samples. 
In cancer genomics, copy number change is one of the hallmarks of the genetic instability common 
    to most human cancers and LOH of tumor suppressor genes is a crucial step in the development of 
sporadic and hereditary cancer (Monti, 2005).

</p>


<h2>Preliminaries</h2>
<ul>
<li>CEL files from an Affymetrix high-density SNP array. </li>
<li>TXT files containing the genotype calls for the SNP array. Each CEL file has a matching TXT file. </li>
<li>Sample information file that describes the SNP array. The array must include
target/normal paired samples for copy number and LOH determination.
See
<a href="http://www.broad.mit.edu/cancer/software/genepattern/tutorial/gp_file_formats.html?snpsample">File Formats</a> 
for a complete description of this GenePattern file format.</li>
</ul>

<div class="steps">
  <h2>Step 1: SNPFileCreator</h2>
  <div class="gpLinks">
  <ul>
    <li><a href="/gp/pages/index.jsf?lsid=SNPFileCreator" 
           onclick="return openModuleWindow(this, event);"
        >Open SNPFileCreator module</a> in the GenePattern window.</li>
    <li><a href="/gp/pages/index.jsf?lsid=SNPFileCreator&zip.filename=ftp://ftp.broad.mit.edu/pub/genepattern/datasets/protocols/DBA_cel_files.zip" 
           onclick="return openModuleWindow(this, event);"
        >Open SNPFileCreator module with example data</a></li>
  </ul>
  </div>
  <h5>What it does</h5>
  <p>Run the SNPFileCreator module to convert a collection of Affymetrix CEL files to a GenePattern SNP file.
     A CEL file contains the raw data for the probes in the SNP probe sets. 
    The SNPFileCreator module converts each probe set to a
    single intensity value per SNP. The conversion is done using one of four modeling algorithms:
    Average Difference, PM/MM Difference Model (dChip, the default), Median Probe, or Trimmed Mean.
  </p>
  <h5>Considerations</h5>
  <p>SNPFileCreator accepts CEL files from the 500K Array Chip Set (250K Sty, 250K NSP) or 
     100K Array Chip Set (50K Xba, 50K Hind). Each chip set uses two unique high density arrays 
     to genotype over 500,000 and 100,000 SNPs in one experiment, respectively.
     The module converts the CEL files for one array into a .snp file. 
     To create a .snp file for a chip set,
     use the MergeRows module to combine the .snp files for the two arrays.</p>
  <p>SNPFileCreator can transfer the CEL files to the GenePattern server for processing or 
     read the files from a network directory. Due to the size of the files, best practice is to
     store the CEL files in a network directory and process them from that directory.</p>
  <p>SNPFileCreator writes the generated .snp file to a network directory or to the 
     GenePattern server. Typically, writing the file to the GenePattern server provides 
     greater flexibility and makes the file available for use in GenePattern pipelines.</p>
  <p>SNPFileCreator creates a .snp file in one of two formats: 
     Non Allele-Specific (default) or Allele-Specific.
     For each sample, the Non Allele-Specific format contains an intensity value 
     and a genotype call; the Allele-Specific format contains an
     intensity value for allele A, intensity value for allele B, and genotype call. 
     All GenePattern modules accept the Non Allele-Specific format; many do not yet accept the Allele-Specific format.</p>
  <p>SNPFileCreator uses the Human Genome of May 2004 (hg17) to include 
     Chromosome and Physical Location columns in the .snp file. By default, it sorts the SNPs
     by chromosome and physical location, as required by the SnpViewer module.</p>
  <div class="gpDocLinks">
  <p>Module documentation: <a href="/gp/getTaskDoc.jsp?name=SNPFileCreator">SNPFileCreator.pdf <img src="/gp/images/pdf.jpg"/></a></p>
  </div>
</div>

<div class="steps">
  <h2>Step 2: XChromosomeCorrect</h2>
  <div class="gpLinks">
  <ul>
    <li><a href="/gp/pages/index.jsf?lsid=XChromosomeCorrect" onclick="return openModuleWindow(this, event);"
        >Open XChromosomeCorrect module</a></li>
  </ul>
  </div>
  <h5>What it does</h5>
  <p>Run the XChromosomeCorrect module to correct intensity values for SNPs on the X chromosome.
     For each sample from a male donor, the module doubles the intensity value for SNPs on the X chromosome.
  </p>
  <h5>Considerations</h5>
  <p>Run XChromosomeCorrect only for gender-specific samples. The sample information file must 
     include a column labeled Gender that contains a value of M or F for each sample.</p>
  <div class="gpDocLinks">
  <p>Module documentation: <a href="/gp/getTaskDoc.jsp?name=XChromosomeCorrect">XChromosomeCorrect.pdf <img src="/gp/images/pdf.jpg"/></a></p>
  </div>
</div>

<div class="steps">
  <h2>Step 3: CopyNumberDivideByNormals</h2>
  <div class="gpLinks">
  <ul>
    <li><a href="/gp/pages/index.jsf?lsid=CopyNumberDivideByNormals" onclick="return openModuleWindow(this, event);"
        >Open CopyNumberDivideByNormals module</a></li>
  </ul>
  </div>
  <h5>What it does</h5>
  <p>Run the CopyNumberDivideByNormals module to compute raw copy number values.
     The module computes the raw copy number of each target SNP by dividing its intensity value 
     by the mean intensity value of all normal SNPs. This calculation is referred to as 
     copy number normalization or normalization with respect to normals. 
  </p>
  <h5>Considerations</h5>
  <p>Include (default) or omit genotype calls from the output file. Including them creates a .xcn file; 
    omitting them creates a .cn file. 
    The SnpViewer module requires genotype calls to detect and display LOH.
  </p>
  <div class="gpDocLinks">
  <p>Module documentation: <a href="/gp/getTaskDoc.jsp?name=CopyNumberDivideByNormals">CopyNumberDivideByNormals.pdf <img src="/gp/images/pdf.jpg"/></a></p>
  </div>
</div>

<div class="steps">
  <h2>Step 4: SnpViewer</h2>
  <div class="gpLinks">
  <ul>
    <li><a href="/gp/pages/index.jsf?lsid=SnpViewer" onclick="return openModuleWindow(this, event);"
        >Open SnpViewer module</a></li>
  </ul>
  </div>
  <h5>What it does</h5>
  <p>Run the SnpViewer module to view SNP copy number and loss of heterozygosity (LOH) data.
     The viewer uses a heat map to display copy number data or LOH calls. 
  </p>
  <h5>Considerations</h5>
  <p>To view a .xcn or .cn file that is on your local drive, run the SnpViewer without specifying 
    any parameters. When the viewer starts, use the File menu to load the file into the viewer. 
    If you specify a local file as a parameter to the SNPViewer module, 
    GenePattern copies the file to the GenePattern server, which can be time consuming for a large
    .xcn or .cn file.</p>
  <p>To detect and display LOH calls, the 
    SnpViewer module requires genotype calls (.xcn file format). The LOH calls are: </p>
    <ul>
    <li>Loss: AB in normal and A or B in target.</li>
    <li>Retained: AB in both normal and target or No Call in normal and AB in target.</li>
    <li>Conflict: A or B in normal and AB in target.</li>
    <li>Non-informative/no call: A or B in normal or No Call in normal or target.</li>
    </ul>
  <p>By default, the viewer displays all chromosomes. To zoom in on a chromosome, select it from the 
    Chromosome drop-down list in the viewer tool bar. To zoom in on a region of the chromosome, 
    select the <i>zoom in</i> tool and click on the heat map.</p>
  <p>To sort samples by copy number amplification or deletion: zoom in on a chromosome; select the 
    <i>define a region of interest</i> tool; in the heat map, click the start of the region of interest and
    then the end of that region; a red bar to the left of the heat map defines the region of interest; 
    right-click the red bar and select <i>sort of amplification</i> or <i>sort of deletion</i>.</p>
  <div class="gpDocLinks">
  <p>Module documentation: <a href="/gp/getTaskDoc.jsp?name=SnpViewer">SNPViewer.pdf <img src="/gp/images/pdf.jpg"/></a></p>
  </div>
</div>
<h2>Reference</h2>
<p>Monti, S. 2005. Class slides: SNP microarrays and high-density genotyping. 
http://www.chip.org/teaching/hst950/slides/class6.pdf.</p>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td align="right">
      <a href="http://www.broad.mit.edu/cancer/software/genepattern/protocols/?p=7">comments/suggestions</a>
    </td>
  </tr>
</table>

</body>
</html>
