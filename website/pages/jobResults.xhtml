<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:tr="http://myfaces.apache.org/trinidad">


<ui:composition template="/templates/common.xhtml">
	<ui:define name="pageTitle">
		Job Results
	</ui:define>
	<ui:define name="scriptCode">
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/MochiKit/MochiKit.js"></script>
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/prototype.js"></script>	
	<script type="text/javascript" language="javascript">

/* <![CDATA[ */
	function toggleCheckBoxes(maincheckbox, theForm, cbId) {		
		var isChecked = maincheckbox.checked;
		var elements = Form.getInputs(theForm , 'checkbox', cbId)	
		for (i = 0; i < elements.length; i++) {			
			elements[i].checked = isChecked;
		}
	}
		
		
	function confirmDelete() {
		var warn = #{jobResultsBean.warnBeforeDeletingJobs};
		if (warn && !confirm('Are you sure you want to delete the selected job(s)?')) return false;
		return true;
	}
	
/* ]]> */

	</script>
	</ui:define>
	
	<ui:define name="body">
		<h:form id="form1">

			<h2>Job Results</h2>

			<h:commandButton action="#{jobResultsBean.deleteJobs}" value="Delete"
				onclick="return confirmDelete();" />

			<t:dataTable id="jobs" value="#{jobResultsBean.jobs}" var="job"
				forceIdIndexFormula="#{job.jobNumber}" styleClass="datagrid">

				<h:column>
					<f:facet name="header">
						<input type="checkbox" value=""
							onclick="toggleCheckBoxes(this, 'form1', 'deleteJobId');" />
					</f:facet>
					<input type="checkbox" name="deleteJobId" value="#{job.jobNumber}" />
				</h:column>

				<h:column>
					<f:facet name="header">
						<t:commandSortHeader columnName="Job Number" arrow="true" id="h1">
							<t:outputText value="Job Number" id="o1" />
						</t:commandSortHeader>
					</f:facet>
					<h:outputText value="#{job.jobNumber}" />
				</h:column>

				<h:column>
					<f:facet name="header">
						<t:commandSortHeader columnName="Name" arrow="true" id="h2">
							<t:outputText value="Name" id="o2" />
						</t:commandSortHeader>
					</f:facet>
					<h:outputText value="#{job.taskName}" />
				</h:column>

				<h:column>
					<f:facet name="header">
						<t:commandSortHeader columnName="Status" arrow="true" id="h3">
							<t:outputText value="Status" id="o3" />
						</t:commandSortHeader>
					</f:facet>
					<h:outputText value="#{job.status}" />
				</h:column>

				<h:column>
					<f:facet name="header">
						<t:commandSortHeader columnName="Submitted" arrow="true" id="h4">
							<t:outputText value="Submitted" id="o4" />
						</t:commandSortHeader>
					</f:facet>
					<h:outputText value="#{job.dateSubmitted}">
						<f:convertDateTime type="date" pattern="EEE, MMM d, ''yy h:mm a" />
					</h:outputText>
				</h:column>

				<h:column>
					<f:facet name="header">
						<t:commandSortHeader columnName="Completed" arrow="true" id="h5">
							<t:outputText value="Completed" id="o5" />
						</t:commandSortHeader>
					</f:facet>
					<h:outputText value="#{job.dateCompleted}">
						<f:convertDateTime type="date" pattern="EEE, MMM d, ''yy h:mm a" />
					</h:outputText>
				</h:column>

			</t:dataTable>

		</h:form>
	</ui:define>
</ui:composition>
</html>
