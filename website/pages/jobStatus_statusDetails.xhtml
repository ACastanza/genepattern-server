<!--
  ~ Copyright 2014 The Broad Institute, Inc.
  ~ SOFTWARE COPYRIGHT NOTICE
  ~ This software and its documentation are the copyright of the Broad Institute, Inc. All rights are reserved.
  ~
  ~ This software is supplied without any warranty or guaranteed support whatsoever. The Broad Institute is not responsible for its use, misuse, or functionality.
  -->


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk">

<!-- include job status details in the JSF job status page
    Inputs:
     int jobNumber
     org.genepattern.server.job.status.Status jobStatus
     int indent
 -->
    <ui:composition>
        <div id="statusDetailsDiv#{jobStatus.gpJobNo}" class="jobContent" style="display: none;" >
            <br />
            <table class="window">
                <tr>
                    <td align="center">
                        <table class="summary" style="width: 100%; margin: auto;" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
                            <tr><th colspan="2">Status</th></tr>
                            <tr><td colspan="2">#{jobStatus.statusMessage}</td></tr>
                            <tr><td style="white-space: nowrap">Queue</td><td style="width: 99%"><h:outputText value="#{jobStatus.queueId}"  /></td></tr>
                            <h:outputText rendered="#{jobStatus.isFinished and jobStatus.exitCode != 0}" escape="false">
                            <tr><td style="white-space: nowrap">Exit Code</td><td style="width: 99%">#{jobStatus.exitCode}</td></tr>
                            </h:outputText>
                            <tr><td style="white-space: nowrap">Status date</td><td style="width: 99%"><h:outputText value="#{jobStatus.statusDate}" converter="gp" /></td></tr>

                            <tr><th colspan="2">Requested resources</th></tr>
                            <h:outputText rendered="#{jobStatus.requestedMemory != null}" escape="false">
                            <tr><td style="white-space: nowrap">job.memory</td><td style="width: 99%">#{jobStatus.requestedMemory.displayValue}</td></tr>
                            </h:outputText>
                            <h:outputText rendered="#{jobStatus.requestedCpuCount != null}" escape="false">
                            <tr><td style="white-space: nowrap">job.cpuCount</td><td style="width: 99%">#{jobStatus.requestedCpuCount}</td></tr>
                            </h:outputText>
                            <h:outputText rendered="#{jobStatus.requestedNodeCount != null}" escape="false">
                            <tr><td style="white-space: nowrap">job.nodeCount</td><td style="width: 99%">#{jobStatus.requestedNodeCount}</td></tr>
                            </h:outputText>
                            <h:outputText rendered="#{jobStatus.requestedWalltime != null}" escape="false">
                            <tr><td style="white-space: nowrap">job.walltime</td><td style="width: 99%">#{jobStatus.requestedWalltime}</td></tr>
                            </h:outputText>
                            <h:outputText rendered="#{jobStatus.requestedQueue != null}" escape="false">
                            <tr><td style="white-space: nowrap">job.queue</td><td style="width: 99%">#{jobStatus.requestedQueue}</td></tr>
                            </h:outputText>
                            
                            <tr><th colspan="2">Event log</th></tr>
                            <tr><td style="white-space: nowrap">Added to GenePattern</td><td style="width: 99%"><h:outputText value="#{jobStatus.dateSubmittedToGp}" converter="gp" /></td></tr>
                            <tr><td style="white-space: nowrap">Submitted to queue</td><td style="width: 99%"><h:outputText value="#{jobStatus.submitTime}" converter="gp" /></td></tr>
                            <tr><td style="white-space: nowrap">Started running</td><td style="width: 99%"><h:outputText value="#{jobStatus.startTime}" converter="gp" /></td></tr>
                            <tr><td style="white-space: nowrap">Finished running</td><td style="width: 99%"><h:outputText value="#{jobStatus.endTime}" converter="gp" /></td></tr>
                            <tr><td style="white-space: nowrap">Completed in GenePattern</td><td style="width: 99%"><h:outputText value="#{jobStatus.dateCompletedInGp}" converter="gp" /></td></tr>
                            <tr><th colspan="2">Usage stats</th></tr>
                            <tr><td style="white-space: nowrap">CPU usage</td><td style="width: 99%"><h:outputText value="#{jobStatus.cpuTime.displayValue}"  /></td></tr>
                            <tr><td style="white-space: nowrap">Max memory</td><td style="width: 99%"><h:outputText value="#{jobStatus.maxMemory.displayValue}"  /></td></tr>
                            <tr><td style="white-space: nowrap">Max swap</td><td style="width: 99%"><h:outputText value="#{jobStatus.maxSwap.displayValue}"  /></td></tr>
                            <tr><td style="white-space: nowrap">Max processes</td><td style="width: 99%"><h:outputText value="#{jobStatus.maxProcesses}"  /></td></tr>
                            <tr><td style="white-space: nowrap">Max threads</td><td style="width: 99%"><h:outputText value="#{jobStatus.maxThreads}"  /></td></tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td align="right" valign="middle">
                        <a style="color:#0066FF;" href="javascript:gpUtil.toggleDiv('statusDetailsDiv#{jobStatus.gpJobNo}', 'Hide', 'Show')"><img src="/gp/images/cross.gif" /> hide</a>
                    </td>
                </tr>
            </table>
        </div>

    </ui:composition>
</html>
