<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- /*
 The Broad Institute
 SOFTWARE COPYRIGHT NOTICE AGREEMENT
 This software and its documentation are copyright (2003-2008) by the
 Broad Institute/Massachusetts Institute of Technology. All rights are
 reserved.
 
 This software is supplied without any warranty or guaranteed support
 whatsoever. Neither the Broad Institute nor MIT can be responsible for its
 use, misuse, or functionality.
 */ -->

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:t="http://myfaces.apache.org/tomahawk" xmlns:c="http://java.sun.com/jstl/core">
<f:view contentType="text/html">
  <head>
    <!-- created by rebecca fagan, fagandesign -->
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
    <title>
      <ui:insert name="pageTitle">GenePattern </ui:insert>
    </title>
    <link href="#{facesContext.externalContext.requestContextPath}/css/style.css" rel="stylesheet" type="text/css"/>
    <link href="#{facesContext.externalContext.requestContextPath}/css/protocols.css" rel="stylesheet" type="text/css"/>
    <link href="#{facesContext.externalContext.requestContextPath}/css/style-jobresults.css" rel="stylesheet" type="text/css"/>
    <link href="#{facesContext.externalContext.requestContextPath}/css/popupMenu.css" rel="stylesheet" type="text/css"/>
    <link href="#{facesContext.externalContext.requestContextPath}/css/style-jobresults.css" rel="stylesheet" type="text/css"/>
    <link href="#{facesContext.externalContext.requestContextPath}/skin/favicon.ico" rel="shortcut icon"/>

    <script type="text/javascript" language="javascript">
      var contextRoot = '#{facesContext.externalContext.requestContextPath}';
      var javaGEInstallerURL = '#{genepatternProperties.properties["JavaGEInstallerURL"]}';
      var createTaskAllowed = #{authorizationBean.createModuleAllowed};
      var createPublicPipelineAllowed = #{authorizationBean.createPublicPipelineAllowed};
      var createPrivatePipelineAllowed = #{authorizationBean.createPrivatePipelineAllowed};
      var createPublicSuiteAllowed = #{authorizationBean.createPublicSuiteAllowed};
      var createPrivateSuiteAllowed = #{authorizationBean.createPrivateSuiteAllowed};
     </script>

    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/prototype.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/genepattern.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/mm_menu.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/mainMenu.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/popupMenu.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/jsval.js"/>
    <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/protocol.js"/>
    <script type="text/javascript" language="javascript">
      /* <![CDATA[ */
      /* Function to support "jsval" based validation.  See registerUser.xhtml for an example.*/
      function validateForm(objForm) {
        var strErrorClass = "error";
        var errMessages = getValidationErrors(objForm, strErrorClass);
        if(errMessages.length == 0) {
          return true;
        }
        else {
          var d = $("errorMessageDiv");
          var t = $("errorMessageContent");
          d.style.display = "";

          var messageString = "<ul style=\"font-weight:bold; color:red;\">";
          for(var i=0; i<errMessages.length; i++) {
            messageString += "<li/>" +  errMessages[i];
          }
          messageString += "</ul>";
          Element.update('errorMessageContent', messageString);
          return false;
        }
      }
       /* ]]> */

      </script>

    <!-- Use this insert to override the "onLoad" initialization method.  This function is triggered from the body onload event.  -->
    <ui:insert name="validationInit">
      <script type="text/javascript" language="javascript"> function onLoad(){}  </script>
    </ui:insert>

    <ui:insert name="headText"/>

  </head>
  <body onload="MM_preloadImages('#{facesContext.externalContext.requestContextPath}/images/menuicon-over.gif'); pm_registerClickHandler(); onLoad();">
    <script language="JavaScript1.2" type="text/javascript">
        var agt = navigator.userAgent.toLowerCase();
        var isSafari2 = agt.indexOf("safari/4") != -1;
        var x = isSafari2 ? -10 : 0;
        var y =  isSafari2 ? 8 : 18;
    	mmLoadMenus();
    </script>

    <!-- User settings area -->
    <t:div rendered="#{!empty requestScope.userID}">
      <table height="30" border="0" cellpadding="0" cellspacing="0" class="loginsettings">
        <tr valign="top">
          <td>
            <h:form id="showSystemMessageForm" rendered="#{!systemMessageBean.isOpen}" style="display: inline;" >
            <h:commandLink value="System Message" actionListener="#{systemMessageBean.show}" style="color: red;" />
            <h:outputText value=" | " />
            </h:form>
            <h:outputLink value="#{facesContext.externalContext.requestContextPath}/pages/accountInfo.jsf">
			My Settings </h:outputLink> | <h:form style="display: inline;">
              <h:commandLink id="logoutLink" action="#{loginBean.logout}"> Sign out </h:commandLink>
            </h:form>&#160;${requestScope.userID}&#160;&#160;&#160;</td>
        </tr>
      </table>
    </t:div>


    <!-- top band with the logo -->
    <div id="topband" class="topband">
      <h:outputLink value="#{facesContext.externalContext.requestContextPath}/pages/index.jsf" target="_top">
        <t:graphicImage value="/images/GP-logo.gif" alt="GenePattern" width="229" height="48" style="border: 0;"/>
      </h:outputLink>
    </div>
    <!-- horizontal navigation band -->
    <div id="navband1" class="navband1" style="white-space: nowrap;">
      <c:if test="#{requestScope.userID != null}">
        <a name="link17" id="link6"
           href="#{facesContext.externalContext.requestContextPath}/pages/index.jsf"
           onclick="MM_showMenu(window.mm_menu_tasks,x,y,null,'link17')"
           onmouseover="MM_showMenu(window.mm_menu_tasks,x,y,null,'link17')"
           onmouseout="MM_startTimeout();">Modules &amp; Pipelines</a> &#160;&#160;&#160;&#160;&#160;&#160;
        <a name="link14" id="link9"
           href="#{facesContext.externalContext.requestContextPath}/pages/manageSuite.jsf"
           onclick="MM_showMenu(window.mm_menu_suites,x,y,null,'link14')"
           onmouseover="MM_showMenu(window.mm_menu_suites,x,y,null,'link14')"
           onmouseout="MM_startTimeout();">Suites</a> &#160;&#160;&#160;&#160;&#160;&#160;
        <a name="link15" id="link10"
           href="#{facesContext.externalContext.requestContextPath}/pages/jobResults.jsf"
           onclick="MM_showMenu(window.mm_menu_jobResults,x,y,null,'link15')"
           onmouseover="MM_showMenu(window.mm_menu_jobResults,x,y,null,'link15')"
           onmouseout="MM_startTimeout();">Job Results</a> &#160;&#160;&#160;&#160;&#160;&#160;
        <a name="link12" id="link3"
           href="#{facesContext.externalContext.requestContextPath}/pages/index.jsf?splash=resources"
           onclick="MM_showMenu(window.mm_menu_resources,x,y,null,'link12')"
           onmouseover="MM_showMenu(window.mm_menu_resources,x,y,null,'link12')"
           onmouseout="MM_startTimeout();">Resources</a> &#160;&#160;&#160;&#160;&#160;&#160;
        <a name="link2" id="link5"
           href="#{facesContext.externalContext.requestContextPath}/pages/index.jsf?splash=downloads"
           onclick="MM_showMenu(window.mm_menu_downloads,x,y,null,'link2')"
           onmouseover="MM_showMenu(window.mm_menu_downloads,x,y,null,'link2')"
           onmouseout="MM_startTimeout();">Downloads</a> &#160;&#160;&#160;&#160;&#160;&#160;
        <c:if test="#{authorizationBean.adminServerAllowed}">
        	<a name="link13" id="link4"
        	    href="#{facesContext.externalContext.requestContextPath}/pages/serverSettings.jsf"
           		onclick="MM_showMenu(window.mm_menu_administration,x,y,null,'link13')"
           		onmouseover="MM_showMenu(window.mm_menu_administration,x,y,null,'link13')"
           		onmouseout="MM_startTimeout();">Administration</a>&#160;&#160;&#160;&#160;&#160;&#160;
          </c:if>
        <a name="link11" id="link1"
           href="#{facesContext.externalContext.requestContextPath}/pages/index.jsf"
           onclick="MM_showMenu(window.mm_menu_documentation,x,y,null,'link11')"
           onmouseover="MM_showMenu(window.mm_menu_documentation,x,y,null,'link11')"
           onmouseout="MM_startTimeout();">Help</a>
     </c:if>
   </div>

    <!--  Main content area -->
    <div id="content" class="content">
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <!-- Spacer used to maintain a minimum height -->
            <img src="#{facesContext.externalContext.requestContextPath}/images/spacer.gif" width="0" height="440"/>
          </td>

          <ui:insert name="leftPanel"/>

          <td valign="top" class="maincontent" id="maincontent">
            <!-- Spacer used to maintain a minimum width, min-width style is not supported on all browsers (IE7, Opera9) -->
            <img src="#{facesContext.externalContext.requestContextPath}/images/spacer.gif" width="570" height="0"/>

            <!-- Include System Alert Message  -->
            <t:div id="systemAlertMessage" rendered="#{systemMessageBean.systemMessage != null}">
                <ui:include src="../pages/systemMessage.xhtml" />
            </t:div>

            <!-- JSF (Server side) errors or messages -->
        <!--    <h:outputText value="Please correct the following errors before proceeding:"
                          rendered="#{empty facesContext.maximumSeverity==FacesMessage.Severity.SEVERITY_ERROR}" style="font-weight:bold"/> -->
		    <h:messages errorClass="validation-error" errorStyle="font-weight:bold; color:red;" layout="table" />
		    <h:outputText rendered="#{!empty facesContext.maximumSeverity}"><br /></h:outputText>

		    <!-- Javascript validation errors.  The JSF and Javascript error blockss will not
		         be visible at the same time (if JS validation fails, the form submit will not
		         occur and thus JSF validation will not be run) -->
		    <div id="errorMessageDiv" style="display:none;">
              <span id="errorMessageHeader" style="font-weight:bold">
                Please correct the following errors before proceeding:
              </span>
              <div id="errorMessageContent"/>
            </div>

		    <!-- Main content body -->
     		<ui:insert name="body" />
           </td>

          <ui:insert name="rightPanel"/>
        </tr>

        <tr>
          <td colspan="4" class="footer">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td>
                  <h:outputLink value="#{facesContext.externalContext.requestContextPath}/pages/about.jsf">About GenePattern</h:outputLink>&#160;|&#160;<h:outputLink value="#{facesContext.externalContext.requestContextPath}/pages/contactUs.jsf">Contact Us</h:outputLink>
                </td>
                <td>
                  <div align="right">&#169;2003-2008&#160; <h:outputLink value="http://www.broad.mit.edu" target="_blank">Broad Institute, MIT</h:outputLink>
                  </div>
                </td>
                <td width="10">&#160;</td>
                <td width="27">
                  <h:outputLink value="http://www.broad.mit.edu" target="_blank">
                    <t:graphicImage value="/images/broad-symbol.gif" alt="Broad Institute" width="27" height="30" style="border: 0;" />
                  </h:outputLink>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </div>

    <ui:insert name="popupMenus"/>

  </body>
  </f:view>
</html>
